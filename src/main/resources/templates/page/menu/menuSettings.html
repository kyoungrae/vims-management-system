<style>
    .gi-popup-body{
        height: 450px !important;
    }
</style>
<article class="gi-article-content gi-col-95 gi-row-90">
    <section class="gi-col-100 gi-row-100">
        <header class="gi-flex gi-flex-center gi-col-5">
            <h1 class="gi-page-title">[Page.Message].Message.Label.Array["COMMON_MENU.TITLE_LIST"]</h1>
        </header>
        <article class=" gi-col-93 gi-row-100">
            <!--      그리드 영역      -->
            <div class="gi-row-100 gi-col-90 gi-flex gi-flex-center gi-padding-left-right-5px">
                <div id="gi-Grid"></div>
                <div class="gi-Grid-side" id="access_group_grid" data-side-grid-open="false"></div>
            </div>
            <!--/     그리드 영역      -->
            <!--      추가버튼 영역      -->
            <div class="gi-row-100 gi-col-30px">
                <div class="gi-btn-section gi-row-30 gi-float-right gi-padding-left-right-20px gi-flex gi-flex-justify-content-flex-end">
                    <button id="menu_depth0_register_btn" class="gi-btn gi-float-right" type="button">[Page.Message].Message.Label.Array["COMMON_MENU.REGISTER_MENU_CODE"]</button>
                    <button id="menu_depth_register_btn" class="gi-btn gi-float-right gi-hidden" type="button">[Page.Message].Message.Label.Array["COMMON_MENU.REGISTER_SUB_MENU_CODE"]</button>
                </div>
            </div>
            <!--/     추가버튼 영역      -->
        </article>
    </section>
</article>
<article id="gi-menu_register-popup" class="gi-popup" data-popup-open="false">
    <div class="gi-popup-body gi-row-40-important">
        <div class="gi-popup-header">
            <span>메뉴등록</span>
        </div>
        <div class="gi-popup-contents">
            <!--      팝업내용 삽입 영역      -->
            <div class="gi-row-100 gi-col-auto gi-flex gi-flex-center">
                <form id="commonMenuRegister" class="gi-row-100 gi-grid gi-grid-justify-items-center">
                    <div class="gi-row-80 gi-padding-5px gi-grid-container gi-grid gi-grid-justify-items-center gi-grid-gap-10px gi-margin-bottom-15px">
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-1-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_top_menu_code" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.TOP_MENU_CODE"]</label>
                                    <input data-gi-tag-disabled data-field="top_menu_code" id="register_top_menu_code" name="top_menu_code" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-2-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_menu_name" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.MENU_NAME"]</label>
                                    <input data-field="menu_name" id="register_menu_name" name="menu_name_kr" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_menu_code" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.MENU_CODE"]</label>
                                    <input data-field="menu_code" id="register_menu_code" name="menu_code" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-2-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_prgm_url" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.PRGM_URL"]</label>
                                    <input data-field="prgm_url" id="register_prgm_url" name="prgm_url" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_url" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.URL"]</label>
                                    <input data-field="url" id="register_url" name="url" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-3-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_menu_number" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.MENU_NUMBER"]</label>
                                    <input inputNumberOnly maxlength="1" data-field="menu_number" id="register_menu_number" name="menu_number" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_use_yn" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.USE_YN"]</label>
                                    <input gi-selectbox data-selectbox-field="USE_YN" data-field="use_yn" id="register_use_yn" name="use_yn" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_menu_level" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.MENU_LEVEL"]</label>
                                    <input inputNumberOnly data-gi-tag-disabled data-field="menu_level" id="register_menu_level" name="menu_level" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off" maxlength="1"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <!--/      팝업내용 삽입 영역      -->
        </div>
        <div class="gi-popup-footer">
            <div class="gi-btn-section gi-row-30 gi-col-30px gi-padding-left-right-20px gi-flex gi-flex-justify-content-center gi-flex-align-items-center">
                <button id="menuRegister-btn" class="gi-popup-update-btn" type="button">[Page.Message].Message.Label.Array["REGISTER_BTN"]</button>
                <button class="gi-popup-close-btn" type="button">[Page.Message].Message.Label.Array["CLOSE_BTN"]</button>
            </div>
        </div>
    </div>
</article>
<!--NOTE: 하위메뉴 등록 팝업-->
<article id="gi-menuDepth_register-popup" class="gi-popup" data-popup-open="false">
    <div class="gi-popup-body gi-row-40-important">
        <div class="gi-popup-header">
            <span>[Page.Message].Message.Label.Array["COMMON_MENU.REGISTER_SUB_MENU_CODE"]s</span>
        </div>
        <div class="gi-popup-contents gi-overflow-scroll">
            <!--      팝업내용 삽입 영역      -->
            <div class="gi-row-100 gi-col-auto gi-flex gi-flex-center">
                <form id="commonMenuDepthRegister" class="gi-row-100 gi-grid gi-grid-justify-items-center">
                    <div class="gi-row-80 gi-padding-5px gi-grid-container gi-grid gi-grid-justify-items-center gi-grid-gap-10px gi-margin-bottom-15px">
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-1-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_top_menu_code" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.TOP_MENU_CODE"]</label>
                                    <input data-gi-tag-disabled data-field="top_menu_code" id="register_depth_top_menu_code" name="top_menu_code" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-2-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_menu_name" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.MENU_NAME"]</label>
                                    <input data-field="menu_name_kr" id="register_depth_menu_name" name="menu_name_kr" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_menu_code" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.MENU_CODE"]</label>
                                    <input data-field="menu_code" id="register_depth_menu_code" name="menu_code" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-2-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_prgm_url" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.PRGM_URL"]</label>
                                    <input data-field="prgm_url" id="register_depth_prgm_url" name="prgm_url" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_url" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">[Page.Message].Message.Label.Array["COMMON_MENU.URL"]</label>
                                    <input data-field="url" id="register_depth_url" name="url" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-3-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_menu_number" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">메뉴순서</label>
                                    <input inputNumberOnly maxlength="1" data-field="menu_number" id="register_depth_menu_number" name="menu_number" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_use_yn" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">사용여부</label>
                                    <input gi-selectbox data-selectbox-field="USE_YN" data-field="use_yn" id="register_depth_use_yn" name="use_yn" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="register_depth_menu_level" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">메뉴레벨</label>
                                    <input inputNumberOnly data-gi-tag-disabled data-field="menu_level" id="register_depth_menu_level" name="menu_level" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off" maxlength="1"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <!--/      팝업내용 삽입 영역      -->
        </div>
        <div class="gi-popup-footer">
            <div class="gi-btn-section gi-row-30 gi-col-30px gi-padding-left-right-20px gi-flex gi-flex-justify-content-center gi-flex-align-items-center">
                <button id="menuDepthRegister-btn" class="gi-popup-update-btn" type="button">등록</button>
                <button class="gi-popup-close-btn" type="button">닫기</button>
            </div>
        </div>
    </div>
</article>
<!--NOTE: 메뉴수정 팝업-->
<article id="gi-menu_update-popup" class="gi-popup" data-popup-open="false">
    <div class="gi-popup-body gi-row-40-important">
        <div class="gi-popup-header">
            <span>메뉴수정</span>
        </div>
        <div class="gi-popup-contents gi-overflow-scroll">
            <!--      팝업내용 삽입 영역      -->
            <div class="gi-row-100 gi-col-auto gi-flex gi-flex-center">
                <form id="commonMenuUpdate" class="gi-row-100 gi-grid gi-grid-justify-items-center">
                    <div class="gi-row-80 gi-padding-5px gi-grid-container gi-grid gi-grid-justify-items-center gi-grid-gap-10px gi-margin-bottom-15px">
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-1-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_top_menu_code" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">상위메뉴코드</label>
                                    <input data-gi-tag-disabled data-field="top_menu_code" id="update_top_menu_code" name="top_menu_code" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-2-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_menu_name" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">메뉴명</label>
                                    <input data-field="menu_name_kr" id="update_menu_name" name="menu_name_kr" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_menu_code" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">메뉴코드</label>
                                    <input data-gi-tag-disabled data-field="menu_code" id="update_menu_code" name="menu_code" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-2-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_prgm_url" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">API 경로</label>
                                    <input data-field="prgm_url" id="update_prgm_url" name="prgm_url" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_url" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">경로</label>
                                    <input data-field="url" id="update_url" name="url" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                        </div>
                        <div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-columns-repeat-3-1fr gi-grid-rows-container">
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_use_yn" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">사용여부</label>
                                    <input gi-selectbox data-selectbox-field="USE_YN" data-field="use_yn" id="update_use_yn" name="use_yn" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_menu_number" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">메뉴순서</label>
                                    <input inputNumberOnly maxlength="1" data-field="menu_number" id="update_menu_number" name="menu_number" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_menu_level" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">메뉴레벨</label>
                                    <input inputNumberOnly data-field="menu_level" id="update_menu_level" name="menu_level" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off" maxlength="1"/>
                                </div>
                            </div>
                            <div class="gi-row-100 gi-col-100 gi-hidden">
                                <div class="gi-row-100 gi-input-container gi-input-container-box-border-shadow gi-flex gi-flex-center ">
                                    <label for="update_menu_sequence" class="gi-input-label" data-focus-label="true" data-focus-label-text-align="default" data-required="true">메뉴고유번호</label>
                                    <input inputNumberOnly data-field="menu_sequence" id="update_menu_sequence" name="menu_sequence" class="gi-input" data-focus-span-text-align="default" data-required="true" autocomplete="off" maxlength="1"/>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <!--/      팝업내용 삽입 영역      -->
        </div>
        <div class="gi-popup-footer">
            <div class="gi-btn-section gi-row-30 gi-col-30px gi-padding-left-right-20px gi-flex gi-flex-justify-content-center gi-flex-align-items-center">
                <button id="menuUpdate-btn" class="gi-popup-update-btn" type="button">수정</button>
                <button class="gi-popup-close-btn" type="button">닫기</button>
            </div>
        </div>
    </div>
</article>
<!-- 접근권한 설정 popup -->
<script type="text/javascript">
    var data_binding = new dataBinding();
    var COMMON_MENU_UPDATE_PRGMID = "commonMenuUpdate";
    var COMMON_MENU_REGISTER_PRGMID = "commonMenuRegister";
    var COMMON_MENU_DEPTH_REGISTER_PRGMID = "commonMenuDepthRegister";
    var common_popup = new popup();
    var rowClickData = [];
    var inputTageReset = new afterLoadDataEvent();

    init();

    function init(){
        //페이지 초기설정
        new PageInit();

        //초기화
        resetEvent();

        //데이터 조회
        findByCommonCodeMenuList();

        setTimeout(function(){
            //클릭 이벤트
            clickEvent();
        });
    }

    function resetEvent(){
        //검색영역 값 초기화
        $("#search-area input").val("");
        $("#search-area select").val("");

        //데이터 호출 후 이벤트 재설정
        inputTageReset.commonTagSettings();
    }

    //클릭 이벤트
    function clickEvent(){
        // 초기화버튼 클릭 이벤트
        $(".gi-btn-reset").click(function(){
            resetEvent();
            // findByCommonCodeMenuList();
        });
        //조회버튼 클릭 이벤트
        $("#search-btn").click(function(){
            // findByCommonCodeMenuList();
        });

        $("#menuUpdate-btn").click(function(){
            commonMenuUpdate();
        })
        $("#menu_depth0_register_btn").click(function(){
            menuRegisterSetting();
        })
        $("#menuRegister-btn").click(function(){
            commonMenuRegister();
        })
        $("#menu_depth_register_btn").click(function(){
            menuDepthRegisterSetting();
        })
        $("#menuDepthRegister-btn").click(function(){
            commonMenuDepthRegister();
        })
    }
    function findByCommonCodeMenuList(page,range,sortId,sortOrder) {
        let url = "/cms/common/commonMenu/findHierarchy";
        let param = {
        };
        // 검색조건 설정 (추가해서 사용)
        let cont1 = $("#menu_name").val();
        if(formUtil.checkEmptyValue(cont1)) param.menu_name = cont1;
        // 정렬조건추가 (기준id, 순서)
        param.sort_id = "menu_name_kr";
        param.sort_order = "ASC";

        axios.post(url, param).then(response => {
            let status = response.status;
            if (status === 200) {
                let data = response.data;

                // 그리드 헤더 설정
                let menuGrid = {
                    title : '[Page.Message].Message.Label.Array["COMMON_MENU.TITLE"]',
                    list:[
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.MENU_NAME_KR"]',      ID:"menu_name_kr",     WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"left",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.MENU_CODE"]',     ID:"menu_code",    WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"left",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.MENU_LEVEL"]',     ID:"menu_level",   WIDTH:"5",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.MENU_NUMBER"]',     ID:"menu_number",  WIDTH:"5",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.TOP_MENU_CODE"]', ID:"top_menu_code",WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"left",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.PRGM_URL"]',     ID:"prgm_url",      WIDTH:"5",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"left",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.URL"]',         ID:"url",          WIDTH:"20",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"left",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.USE_YN"]',     ID:"use_yn",        WIDTH:"7",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",COMMON_CODE_GROUP_ID:"USE_YN",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["MODIFY_BTN"]',        ID:"update_menu_btn",     WIDTH:"5",TYPE:"button",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["DELETE_BTN"]',        ID:"delete_menu_btn",     WIDTH:"5",TYPE:"button",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:false},
                        // {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.REGISTER_MENU_ACCESS_GROUP_BTN"]',ID:"access_right_group",     WIDTH:"5",TYPE:"button",FONT_SIZE:"12px",TEXT_ALIGN:"center",VISIBLE_OPTION_BTN:{"menu_level":"0"},HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.REGISTER_MENU_ACCESS_GROUP_BTN"]',ID:"access_right_group",     WIDTH:"5",TYPE:"button",FONT_SIZE:"12px",TEXT_ALIGN:"center",VISIBLE_OPTION_BTN:[{"menu_level":"0"},{"menu_level":"1"}],HIDDEN:false},

                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.MENU_SEQUENCE"]',  ID:"menu_sequence",  WIDTH:"5",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.MENU_NAME_EN"]',      ID:"menu_name_en",     WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"left",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.MENU_NAME_MN"]',      ID:"menu_name_mn",     WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"left",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.USE_YN"]',     ID:"use_yn",        WIDTH:"20",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true},
                        {HEADER:"No",         ID:"no",              WIDTH:"7",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.SYSTEM_CREATE_DATE"]',     ID:"system_create_date",   WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.SYSTEM_CREATE_USERID"]',     ID:"system_create_userid", WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.SYSTEM_UPDATE_DATE"]',     ID:"system_update_date",   WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_MENU.SYSTEM_UPDATE_USERID"]',     ID:"system_update_userid", WIDTH:"15",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true}
                    ]
                }
                //그리드 생성 <div id="gi-Grid"></div>
                let menu_grid = formUtil.giGridHierarchy(menuGrid,"","","gi-Grid");
                //계층 구조 기준컬럼명 설정
                menu_grid.HierarchyOption({level_column:"menu_level",parent_depth_column:"menu_code",child_depth_column:"top_menu_code"});
                //그리드 데이터 설정
                menu_grid.DataSet(data);
                //그리드 내부의 상세 버튼 클릭 이벤트 설정(버튼클릭시 호출될 함수, 그리드 헤더 부분에 설정한 버튼 ID)
                menu_grid.updateBtnClick(menuUpdateSetting,"update_menu_btn");
                menu_grid.deleteBtnClick(commonMenuDelete,"delete_menu_btn");

                //그리스 내부의 header click 정렬 이벤트 설정
                //menu_grid.sortDataSet(findByCommonCodeMenuList);

                menu_grid.sideOpenBtnClick("access_group_grid","access_right_group");
                menu_grid.detailBtnClick(accessGroupStatus,"access_right_group");
                //그리드 row 선택 이벤트 설정
                menu_grid.rowClick(rowClickEvent);
                function rowClickEvent(rows,e){
                    let clickFlag = $(e.currentTarget).hasClass("gi-grid-list-select");

                    let sideGridOpenFlag = $("#access_group_grid").attr("data-side-grid-open");
                    if(clickFlag){
                        if(sideGridOpenFlag === "true"){
                            let accessGroupBtnActive = $(e.currentTarget).find("li[data-field='access_right_group']").children().length > 0;
                            if(accessGroupBtnActive){
                                findByCommonGroupList(null,null,null,null,rows);
                                findByCommonAccessGroupMenuList(null,null,null,null,rows);
                            }else{
                                findByCommonGroupList(null,null,null,null,null);
                                findByCommonAccessGroupMenuList(null,null,null,null,null);
                            }
                        }
                        if(rows.menu_level !== "2"){
                            $("#menu_depth_register_btn").removeClass("gi-hidden");
                            rowClickData = rows;
                        }else{
                            $("#menu_depth_register_btn").addClass("gi-hidden");
                            rowClickData = rows;
                        }
                    }else{
                        $("#menu_depth_register_btn").addClass("gi-hidden");
                    }
                }
            } else {
                formUtil.alertPopup("response status is :" + status);
            }
        }).catch(error => {
            formUtil.alertPopup(error);
        })
    }
    async function accessGroupStatus(data){
        let htmlSource =
             '<div class="gi-row-100 gi-col-100 gi-grid gi-grid-template-rows-repeat-2-1fr">'
            +'  <div class="gi-row-100 gi-grid gi-col-360px">'
            +'    <span class="gi-text-align-center">그룹 목록</span>'
            +'    <div id="gi-Grid2" class="gi-Grid gi-row-100"></div>'
            +'  </div>'
            +'  <div class="gi-row-100 gi-grid gi-col-400px">'
            +'    <span class="gi-text-align-center">권한 적용 그룹 목록</span>'
            +'    <div id="gi-Grid3" class="gi-Grid gi-row-100"></div>'
            +'  </div>'
            +'</div>';
        await $("#access_group_grid").append(htmlSource);
        await findByCommonGroupList(null,null,null,null,data);
        await findByCommonAccessGroupMenuList(null,null,null,null,data);
    }
    /**
     * NOTE : 그룹 목록
     * @param page
     * @param range
     * @param sortId
     * @param sortOrder
     * @param cont
     */
    function findByCommonGroupList(page,range,sortId,sortOrder,cont) {
        let url = "/cms/common/commonGroup/findNotExistsCommonAccessGroupMenu";
        let param = {
        };
        // 검색조건 설정 (추가해서 사용)
        if(cont !== null) if(formUtil.checkEmptyValue(cont.menu_code)) param.menu_code = cont.menu_code;
        axios.post(url, param).then(response => {
            let status = response.status;
            if (status === 200) {
                let data = response.data;
                // 그리드 헤더 설정
                let commonGroup_menuGrid_header = {
                    title : "그룹아이디 목록",
                    list:[
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_GROUP.GROUP_NAME"]',  ID:"group_name",  WIDTH:"30",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_GROUP.TOP_GROUP_ID"]',  ID:"top_group_id",  WIDTH:"20",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_GROUP.GROUP_ID"]',  ID:"group_id",  WIDTH:"20",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_GROUP.USE_YN"]',  ID:"use_yn",  WIDTH:"20",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",COMMON_CODE_GROUP_ID:"USE_YN",HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_GROUP.GROUP_LEVEL"]',  ID:"group_level",  WIDTH:"5",TYPE:"text",FONT_SIZE:"12px",TEXT_ALIGN:"center",HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["REGISTER_BTN"]',  ID:"register_btn",  WIDTH:"10",TYPE:"button",FONT_SIZE:"12px",TEXT_ALIGN:"center",VISIBLE_OPTION_BTN:{"group_level":"0"},HIDDEN:false},
                    ]
                }
                //그리드 생성 <div id="gi-Grid"></div>
                let commonGroup_menu_grid = formUtil.giGridHierarchy(commonGroup_menuGrid_header,null,null,"gi-Grid2");

                commonGroup_menu_grid.HierarchyOption({level_column:"group_level",parent_depth_column:"group_id",child_depth_column:"top_group_id"});
                //그리드 데이터 설정
                if(cont !== null){
                    commonGroup_menu_grid.DataSet(data);
                }else{
                    commonGroup_menu_grid.DataSet();
                }

                commonGroup_menu_grid.detailBtnClick(registerAccessGroupInMenu,"register_btn");

                function registerAccessGroupInMenu(row){
                    row["menu_code"] = cont.menu_code;
                    accessGroupInMenuRegister(row);
                }

            } else {
                formUtil.alertPopup("response status is :" + status);
            }
        }).catch(error => {
            formUtil.alertPopup(error);
        })
    }
    function accessGroupInMenuRegister(row){
        let flag = true;
        if(flag){
            let url = "/cms/common/commonAccessGroupMenu/register";
            let param = {
                menu_code : row.menu_code,
                access_rights_group_id : row.group_id
            };
            axios.post(url,param).then(response =>{
                let status = response.status;
                if (status === 200) {
                    formUtil.showMessage(Message.Label.Array["COMPLETE.INSERT"]);
                    findByCommonGroupList(null,null,null,null,row);
                    findByCommonAccessGroupMenuList(null,null,null,null,row);
                } else {
                    formUtil.alertPopup("response status is :" + status);
                }
            }).catch(error => {
                formUtil.alertPopup(error.response.data);
            })
        }
    }

    /**
     * NOTE: 권한 적용 그룹 목록
     * @param page
     * @param range
     * @param sortId
     * @param sortOrder
     * @param cont
     */
    function findByCommonAccessGroupMenuList(page,range,sortId,sortOrder,cont) {
        //default page
        if(!formUtil.checkEmptyValue(page)) page = 1;
        //default range(row)
        if(!formUtil.checkEmptyValue(range)) range = 10;

        let url = "/cms/common/commonAccessGroupMenu/findPage";
        let param = {
            page_no:page,
            row_range : range,
            offset: (page-1) * range
        };
        if(cont !== null) if(formUtil.checkEmptyValue(cont.menu_code)) param.menu_code = cont.menu_code;
        // 정렬조건추가 (기준id, 순서)
        if(formUtil.checkEmptyValue(sortId)) param.sort_id = sortId;
        if(formUtil.checkEmptyValue(sortOrder)) param.sort_order = sortOrder;

        axios.post(url, param).then(response => {
            let status = response.status;
            if (status === 200) {
                let data = response.data.DATA;
                let paging = response.data.TOTAL_PAGING[0];

                // 그리드 헤더 설정
                let commonAccessGroupMenu_menuGrid_header = {
                    title : '[Page.Message].Message.Label.Array["COMMON_ACCESS_GROUP_MENU.TITLE"]',
                    list:[
                        {HEADER:'No',  ID:'no',   WIDTH:'7',TYPE:'text',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_ACCESS_GROUP_MENU.MENU_CODE"]',  ID:'menu_code',  WIDTH:'40',TYPE:'text',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_ACCESS_GROUP_MENU.ACCESS_RIGHTS_GROUP_ID"]',  ID:'access_rights_group_id',  WIDTH:'40',TYPE:'text',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:false},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_ACCESS_GROUP_MENU.SYSTEM_CREATE_DATE"]',  ID:'system_create_date',  WIDTH:'40',TYPE:'text',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_ACCESS_GROUP_MENU.SYSTEM_CREATE_USERID"]',  ID:'system_create_userid',  WIDTH:'40',TYPE:'text',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_ACCESS_GROUP_MENU.SYSTEM_UPDATE_DATE"]',  ID:'system_update_date',  WIDTH:'40',TYPE:'text',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["COMMON_ACCESS_GROUP_MENU.SYSTEM_UPDATE_USERID"]',  ID:'system_update_userid',  WIDTH:'40',TYPE:'text',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:true},
                        {HEADER:'[Page.Message].Message.Label.Array["DELETE_BTN"]',  ID:'delete_btn',  WIDTH:'15',TYPE:'button',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:false}
                        <!--{HEADER:'사이드 그리드',  ID:'sideGridOpen_btn',  WIDTH:'15',TYPE:'button',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:false}-->
                        <!--{HEADER:'checkbox',  ID:'checkbox',  WIDTH:'25',TYPE:'checkbox',FONT_SIZE:'12px',TEXT_ALIGN:'center',HIDDEN:false},-->
                    ]
                }
                //그리드 생성 <div id="gi-Grid"></div>
                let commonAccessGroupMenu_menu_grid = formUtil.giGrid(commonAccessGroupMenu_menuGrid_header,paging,page,"gi-Grid3");

                //그리드 하이라키 구조로 변경
                //let commonAccessGroupMenu_menu_grid = formUtil.giGridHierarchy(commonAccessGroupMenu_menuGrid_header,paging,page);
                //commonAccessGroupMenu_menu_grid.HierarchyOption({level_column:"",parent_depth_column:"",child_depth_column:""});

                //사이드 그리드 설정
                //commonAccessGroupMenu_menu_grid.sideOpenBtnClick("gi-Grid-side","sideGridOpen_btn");

                //그리드 데이터 설정
                if(cont !== null){
                    commonAccessGroupMenu_menu_grid.DataSet(data);
                }else{
                    commonAccessGroupMenu_menu_grid.DataSet();
                }
                //그리드 row 개수 변경 및 페이징 버튼 이벤트 설정
                commonAccessGroupMenu_menu_grid.pagingSet(findByCommonAccessGroupMenuList);

                //그리드 내부의 상세 버튼 클릭 이벤트 설정(버튼클릭시 호출될 함수, 그리드 헤더 부분에 설정한 버튼 ID)
                // commonAccessGroupMenu_menu_grid.detailBtnClick(redirectDetailPage,"detail_btn");

                commonAccessGroupMenu_menu_grid.deleteBtnClick(deleteCommonAccessGroupId,"delete_btn");

                //그리스 내부의 header click 정렬 이벤트 설정
                commonAccessGroupMenu_menu_grid.sortDataSet(findByCommonAccessGroupMenuList);

                function deleteCommonAccessGroupId(row){
                    commonAccessGroupIdRemove(row);
                }
            } else {
                formUtil.alertPopup("response status is :" + status);
            }
        }).catch(error => {
            formUtil.alertPopup(error.response.data);
        })
    }
    function menuRegisterSetting(){
        $("#gi-menu_register-popup").attr("data-popup-open","true");
        $("#register_top_menu_code").val("-");
        $("#register_menu_level").val("0");
        commonTag.inputTagReset($(".gi-input"));
    }
    function menuDepthRegisterSetting(){
        $("#gi-menuDepth_register-popup").attr("data-popup-open","true");
        $("#register_depth_top_menu_code").val(rowClickData.menu_code);
        $("#register_depth_menu_level").val((parseInt(rowClickData.menu_level)+1)+"");

        inputTageReset.commonTagSettings();
    }
    function menuUpdateSetting(cont){
        $("#gi-menu_update-popup").attr("data-popup-open","true");
        data_binding.setDataSelectBox("update_use_yn",cont.use_yn);
        data_binding.setDataForm("gi-menu_update-popup",cont);
    }
    /**
     * NOTE: 상위메뉴등록
     */
    function commonMenuRegister(){
        let flag =  checkRegisterPopupValidation();
        if(flag){
            let url = "/cms/common/commonMenu/register"
            let data = new dataBinding().getData(COMMON_MENU_REGISTER_PRGMID);
            let param = {
                menu_code : data.menu_code,
                menu_name_kr : data.menu_name,
                menu_number : data.menu_number,
                menu_level : data.menu_level,
                top_menu_code : data.top_menu_code,
                url : data.url,
                prgm_url : data.prgm_url,
                use_yn : data.use_yn
            };

            axios.post(url, param).then(response =>{
                if(response.status === 200){
                    formUtil.showMessage(Message.Label.Array["COMPLETE.INSERT"]);
                    common_popup.close("gi-menu_register-popup");
                    findByCommonCodeMenuList();
                    findByMenuList();
                }else{
                    formUtil.showMessage(Message.Label.Array["FAIL.INSERT"])
                }
            }).catch(error =>{
                formUtil.alertPopup(error.response.data);
            })
        }
    }

    /**
     * NOTE: 하위메뉴등록
     */
    function commonMenuDepthRegister(){
        let flag =  checkValidation(COMMON_MENU_DEPTH_REGISTER_PRGMID);
        if(flag){
            let url = "/cms/common/commonMenu/register"
            let data = new dataBinding().getData(COMMON_MENU_DEPTH_REGISTER_PRGMID);
            let param = {
                menu_code : data.menu_code,
                menu_name_kr : data.menu_name_kr,
                menu_number : data.menu_number,
                menu_level : data.menu_level,
                top_menu_code : data.top_menu_code,
                url : data.url,
                prgm_url : data.prgm_url,
                use_yn : data.use_yn
            };

            axios.post(url, param).then(response =>{
                if(response.status === 200){
                    formUtil.showMessage(Message.Label.Array["COMPLETE.INSERT"]);
                    common_popup.close("gi-menuDepth_register-popup");
                    findByCommonCodeMenuList();
                    findByMenuList();
                }else{
                    formUtil.showMessage(Message.Label.Array["FAIL.INSERT"])
                }
            }).catch(error =>{
                formUtil.alertPopup(error.response.data);
            })
        }
    }
    /**
     * NOTE: 메뉴 업데이트 API
     */
    function commonMenuUpdate(){
        let data = new dataBinding().getData(COMMON_MENU_UPDATE_PRGMID);
        let url = "/cms/common/commonMenu/update";
        let param = {
            menu_code :data.menu_code ,
            menu_name_kr :data.menu_name_kr ,
            menu_number :data.menu_number ,
            menu_level :data.menu_level ,
            top_menu_code :data.top_menu_code ,
            url :data.url ,
            prgm_url : data.prgm_url,
            use_yn :data.use_yn,
            menu_sequence : data.menu_sequence
            //,access_right_group : data.access_right_group
        };
         axios.post(url, param).then(response =>{
             if(response.status === 200){
                 formUtil.showMessage(Message.Label.Array["COMPLETE.UPDATE"]);
                 common_popup.close("gi-menu_update-popup");
                 findByCommonCodeMenuList();
                 findByMenuList();
             }else{
                 formUtil.showMessage(Message.Label.Array["FAIL.UPDATE"]);
             }
         }).catch(error =>{
             formUtil.alertPopup(error + "");
         })
    }
    /**
     * NOTE: 메뉴 ROW DATA 삭제
     * @param cont
     */
    function commonMenuDelete(cont){
        let data = cont;
        let url = "/cms/common/commonMenu/removeMenuCode";
        let param = {
            menu_code : data.menu_code,
            menu_sequence: data.menu_sequence
        };
        axios.post(url, param).then(response =>{
            formUtil.showMessage(Message.Label.Array["COMPLETE.DELETE"]);
            findByCommonCodeMenuList();
            findByMenuList();
        }).catch(error =>{
            formUtil.alertPopup(error.response.data);
        })
    }
    function checkRegisterPopupValidation(){
        let flag = false;
        let validation = $('#'+COMMON_MENU_REGISTER_PRGMID+' [data-required="true"]')
            .filter((_, el) => formUtil.checkEmptyValue(el.id))
            .map((_, el) => ({
                id: el.id,
                message: Message.Label.Array["COMMON_MENU.CHECK." + el.name.toUpperCase()]
            })).get();
        validation.formId = COMMON_MENU_REGISTER_PRGMID;
        if (formUtil.validationCheck(validation)) {
            flag = true;
        }
        return flag;
    }
    function checkValidation(ID){
        let flag = false;

        let validation = [];
        validation.formId = ID;
        $(".gi-input[data-required='true'],.gi-select[data-required='true']").map((i,item)=>{
            if($(item).data("field")){
                let messageId = $(item).data("field").toUpperCase();
                let message = Message.Label.Array["COMMON_GROUP.CHECK."+messageId];
                validation.push({id:item.id,message:message});
            }
        });
        if(formUtil.validationCheck(validation)){
            flag = true;
        }
        return flag;
    }
    function commonAccessGroupIdRemove(cont){
        let url = "/cms/common/commonAccessGroupMenu/remove";
        let param = {
            menu_code : cont.menu_code,
            access_rights_group_id : cont.access_rights_group_id
        }
        axios.post(url, param).then(response =>{
            if(response.status === 200){
                formUtil.showMessage(Message.Label.Array["COMPLETE.DELETE"]);
                findByCommonGroupList(null,null,null,null,cont);
                findByCommonAccessGroupMenuList(null,null,null,null,cont);
            }
        }).catch(error =>{
            formUtil.alertPopup(error.response.data);
        })
    }
</script>
